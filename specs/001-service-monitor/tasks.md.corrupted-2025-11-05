# Tasks: Windowsã‚µãƒ¼ãƒ“ã‚¹ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ # Tasks: Windowsã‚µãƒ¼ãƒ“ã‚¹ç›£è¦–ã‚·ã‚¹ãƒEï¿½ï¿½



**Input**: Design documents from `/specs/001-service-monitor/`**Feature**: 001-service-monitor  

**Prerequisites**: plan.md, spec.md, research.md, data-model.md, contracts/**Input**: Design documents from `/specs/001-service-monitor/`  

**Prerequisites**: plan.md, spec.md, data-model.md, contracts/, research.md, quickstart.md

**Tests**: This feature specification does not explicitly request tests. Test tasks are EXCLUDED per template guidelines.

## Task Format

**Organization**: Tasks are grouped by user story to enable independent implementation and testing of each story.

**Format**: `- [ ] [TaskID] [P?] [Story?] Description with file path`

## Format: `[ID] [P?] [Story] Description`

**Labels**:

- **[P]**: Can run in parallel (different files, no dependencies)- **[P]**: Parallelizable (can run concurrently with other [P] tasks)

- **[Story]**: Which user story this task belongs to (e.g., US1, US2, US3, US4)- **[US1]**: User Story 1 (Service monitoring and notification - P1)

- Include exact file paths in descriptions- **[US2]**: User Story 2 (Service list display and selection - P2)

- **[US3]**: User Story 3 (Configuration file management - P3)

## Path Conventions

## Implementation Strategy

- **Source**: `ServiceWatcher/` at repository root

- **Tests**: `tests/` at repository root**MVP Scope**: User Story 1 (US1) only - Core monitoring and notification

- Paths use Windows-style backslashes for .NET project**Incremental Delivery**: US1 â†EUS2 â†EUS3 (each story is independently testable)

**Technology**: C# 12 / .NET 8.0, Windows Forms, System.ServiceProcess

---

---

## Phase 1: Setup (Shared Infrastructure)

## Phase 1: Setup (Project Initialization)

**Purpose**: Project initialization and basic structure

**Purpose**: Initialize project structure and dependencies

- [ ] T001 Create directory structure: ServiceWatcher/{Models,Services,UI,Utils,Resources}

- [ ] T002 Create directory structure: tests/{Unit/{Models,Services,Utils},Integration/Services}- [X] T001 Create Visual Studio solution file at ServiceWatcher.sln

- [ ] T003 Initialize .NET 8.0 Windows Forms project in ServiceWatcher/ with ServiceWatcher.csproj- [X] T002 [P] Create main project file ServiceWatcher.csproj with .NET 8.0 target

- [ ] T004 [P] Add NuGet packages: System.ServiceProcess.ServiceController, System.Text.Json- [X] T003 [P] Create test project file tests/ServiceWatcher.Tests.csproj

- [ ] T005 [P] Configure project properties: OutputType=WinExe, TargetFramework=net8.0-windows, UseWindowsForms=true- [X] T004 [P] Add NuGet packages: System.ServiceProcess, System.Text.Json to ServiceWatcher.csproj

- [X] T005 [P] Add NuGet packages: xUnit, Moq, Microsoft.NET.Test.Sdk to tests project

**Checkpoint**: Project structure ready for implementation- [X] T006 [P] Create directory structure: Models/, Services/, UI/, Utils/ in project root

- [X] T007 [P] Create test directory structure: tests/Unit/, tests/Integration/

---- [X] T008 [P] Add Microsoft.Extensions.Logging package for logging support

- [X] T009 Create default config.json template file in project root

## Phase 2: Foundational (Blocking Prerequisites)- [X] T010 Configure project properties: Windows application, enable Windows Forms



**Purpose**: Core infrastructure that MUST be complete before ANY user story can be implemented---



**âš ï¸ CRITICAL**: No user story work can begin until this phase is complete## Phase 2: Foundational (Core Infrastructure)



- [ ] T006 [P] Create ServiceStatus enum in ServiceWatcher/Models/ServiceStatus.cs with 8 states (Unknown, Stopped, StartPending, StopPending, Running, ContinuePending, PausePending, Paused)**Purpose**: Base classes and utilities needed by all user stories

- [ ] T007 [P] Create Result<T> class in ServiceWatcher/Utils/Result.cs with Success/Failure factory methods

- [ ] T008 [P] Create MonitoredService model in ServiceWatcher/Models/MonitoredService.cs with 7 properties per data-model.md### Result Type and Validation

- [ ] T009 [P] Create ApplicationConfiguration model in ServiceWatcher/Models/ApplicationConfiguration.cs with DetectDefaultLanguage() helper

- [ ] T010 [P] Create ServiceStatusChange model in ServiceWatcher/Models/ServiceStatusChange.cs with IsStopEvent helper property- [X] T011 [P] Create Result<T> class in Utils/Result.cs for explicit success/failure handling

- [ ] T011 Create ConfigurationValidator in ServiceWatcher/Utils/ConfigurationValidator.cs with Validate() method for all validation rules- [X] T012 [P] Create ValidationResult class in Utils/ValidationResult.cs with error list

- [ ] T012 Create Logger wrapper in ServiceWatcher/Utils/Logger.cs using Microsoft.Extensions.Logging abstractions- [X] T013 [P] Create ServiceStatus enum in Models/ServiceStatus.cs mapping to ServiceControllerStatus

- [ ] T013 Create IConfigurationManager interface in ServiceWatcher/Services/IConfigurationManager.cs per contracts/IConfigurationManager.md

- [ ] T014 Create IServiceMonitor interface in ServiceWatcher/Services/IServiceMonitor.cs per contracts/IServiceMonitor.md### Logging Infrastructure

- [ ] T015 Create INotificationService interface in ServiceWatcher/Services/INotificationService.cs per contracts/INotificationService.md

- [ ] T016 Create ILocalizationService interface in ServiceWatcher/Services/ILocalizationService.cs per contracts/ILocalizationService.md- [X] T014 [P] Create Logger class in Utils/Logger.cs wrapping Microsoft.Extensions.Logging

- [X] T015 [P] Implement log file rotation logic (10MB max, keep 10 files) in Utils/Logger.cs

**Checkpoint**: Foundation ready - user story implementation can now begin in parallel

### Extension Methods

---

- [X] T016 [P] Create ServiceControllerExtensions class in Utils/ServiceControllerExtensions.cs

## Phase 3: User Story 1 - ã‚µãƒ¼ãƒ“ã‚¹ç›£è¦–ã¨é€šçŸ¥ (Priority: P1) ğŸ¯ MVP- [X] T017 [P] Add ToServiceStatus() extension method to convert ServiceControllerStatus to ServiceStatus



**Goal**: ç™»éŒ²ã•ã‚ŒãŸWindowsã‚µãƒ¼ãƒ“ã‚¹ãŒåœæ­¢ã—ãŸéš›ã«å³åº§ã«ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—é€šçŸ¥ã‚’å—ã‘å–ã‚Šã€ã‚µãƒ¼ãƒ“ã‚¹åœæ­¢ã‚’è¿…é€Ÿã«èªè­˜ã§ãã‚‹---



**Independent Test**: ç›£è¦–å¯¾è±¡ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ‰‹å‹•ã§åœæ­¢ã™ã‚‹ã“ã¨ã§ã€1ç§’ä»¥å†…ã«ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—é€šçŸ¥ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã€ç‹¬ç«‹ã—ãŸä¾¡å€¤ã‚’æä¾›ã—ã¾ã™ (spec.md US1å—ã‘å…¥ã‚Œã‚·ãƒŠãƒªã‚ª1-4ã‚’å‚ç…§)## Phase 3: User Story 1 - Service Monitoring and Notification (P1)



### Implementation for User Story 1**Goal**: Monitor registered services and show popup notification when service stops  

**Independent Test**: Manually stop a monitored service â†Epopup appears within 1 second  

- [ ] T017 [P] [US1] Implement ServiceMonitor class in ServiceWatcher/Services/ServiceMonitor.cs with StartMonitoringAsync(), StopMonitoringAsync(), CheckAllServicesAsync() methods**Success Criteria**: SC-002 (notification within 1 second), SC-003 (resource usage), SC-007 (24h stability)

- [ ] T018 [P] [US1] Implement NotificationService class in ServiceWatcher/Services/NotificationService.cs with ShowNotification(), CloseAllNotifications() methods

- [ ] T019 [US1] Create NotificationForm in ServiceWatcher/UI/NotificationForm.cs with service name label, stop time label, OK button, auto-close timer (FR-011: 30ç§’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ)### Data Models (US1)

- [ ] T020 [US1] Implement ServiceMonitor.StartMonitoringAsync() with Timer-based polling loop (FR-003: 5ç§’é–“éš”ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ)

- [ ] T021 [US1] Implement ServiceMonitor.CheckAllServicesAsync() with ServiceController.Status checks and status change detection (FR-004: 1ç§’ä»¥å†…é€šçŸ¥)- [X] T018 [P] [US1] Create MonitoredService class in Models/MonitoredService.cs with all properties

- [ ] T022 [US1] Wire ServiceMonitor.ServiceStatusChanged event to NotificationService.ShowNotification() with displayTime from config (FR-005: ã‚µãƒ¼ãƒ“ã‚¹åã€è¡¨ç¤ºåã€åœæ­¢æ™‚åˆ»ã€åœæ­¢ç†ç”±å«ã‚€)- [X] T019 [P] [US1] Create ServiceStatusChange class in Models/ServiceStatusChange.cs with event details

- [ ] T023 [US1] Add error handling for Win32Exception and InvalidOperationException in ServiceMonitor (FR-012: ç®¡ç†è€…æ¨©é™ãªã—ã§åŸºæœ¬æ©Ÿèƒ½æä¾›)- [X] T020 [P] [US1] Add IsStopEvent helper property to ServiceStatusChange class

- [ ] T024 [US1] Add logging for monitoring start/stop, service status changes, notification display, errors in ServiceMonitor and NotificationService

### Service Layer - Monitoring (US1)

**Checkpoint**: At this point, User Story 1 should be fully functional and testable independently - service monitoring and notification popup work end-to-end

- [X] T021 [US1] Create IServiceMonitor interface in Services/IServiceMonitor.cs with monitoring operations

---- [X] T022 [US1] Implement ServiceMonitor class constructor and fields in Services/ServiceMonitor.cs

- [X] T023 [US1] Implement StartMonitoringAsync method with Timer-based polling in Services/ServiceMonitor.cs

## Phase 4: User Story 2 - ã‚µãƒ¼ãƒ“ã‚¹ä¸€è¦§è¡¨ç¤ºã¨é¸æŠ (Priority: P2)- [X] T024 [US1] Implement StopMonitoringAsync method with graceful cancellation in Services/ServiceMonitor.cs

- [X] T025 [US1] Implement CheckAllServicesAsync method with status comparison in Services/ServiceMonitor.cs

**Goal**: ã‚·ã‚¹ãƒ†ãƒ ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹Windowsã‚µãƒ¼ãƒ“ã‚¹ã®ä¸€è¦§ã‚’è¡¨ç¤ºã—ã€ç›£è¦–ã—ãŸã„ã‚µãƒ¼ãƒ“ã‚¹ã‚’é¸æŠã—ã¦ç™»éŒ²ã§ãã‚‹- [X] T026 [US1] Implement GetCurrentStatusAsync helper method in Services/ServiceMonitor.cs

- [X] T027 [US1] Add ServiceStatusChanged event raising logic in Services/ServiceMonitor.cs

**Independent Test**: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’èµ·å‹•ã—ã¦ã‚µãƒ¼ãƒ“ã‚¹ä¸€è¦§ç”»é¢ã‚’é–‹ãã€ä»»æ„ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’é¸æŠã—ã¦ç™»éŒ²ã™ã‚‹ã“ã¨ã§ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã¾ã™ (spec.md US2å—ã‘å…¥ã‚Œã‚·ãƒŠãƒªã‚ª1-4ã‚’å‚ç…§)- [X] T028 [US1] Add MonitoringError event for exception handling in Services/ServiceMonitor.cs

- [X] T029 [US1] Implement error handling for InvalidOperationException (service not found)

### Implementation for User Story 2- [X] T030 [US1] Implement error handling for Win32Exception (access denied)



- [ ] T025 [P] [US2] Create MainForm in ServiceWatcher/UI/MainForm.cs with monitoring start/stop buttons, service list grid, status bar### Service Layer - Notifications (US1)

- [ ] T026 [P] [US2] Create ServiceListForm in ServiceWatcher/UI/ServiceListForm.cs with all services grid, search textbox, add/remove buttons

- [ ] T027 [US2] Implement ServiceListForm.LoadAllServices() using ServiceController.GetServices() to enumerate all Windows services (FR-001)- [X] T031 [P] [US1] Create INotificationService interface in Services/INotificationService.cs

- [ ] T028 [US2] Implement ServiceListForm search functionality with service name filtering (FR-008)- [X] T032 [US1] Implement NotificationService class constructor in Services/NotificationService.cs

- [ ] T029 [US2] Implement ServiceListForm.AddButton_Click() to add selected service to MonitoredServices list and trigger config save (FR-002)- [X] T033 [US1] Implement ShowNotification method with SynchronizationContext marshaling

- [ ] T030 [US2] Implement ServiceListForm.RemoveButton_Click() to remove service from MonitoredServices and trigger config save (FR-007)- [X] T034 [US1] Implement CloseAllNotifications method in Services/NotificationService.cs

- [ ] T031 [US2] Implement MainForm.ServiceListGrid data binding to display ApplicationConfiguration.MonitoredServices with columns: ServiceName, DisplayName, LastKnownStatus, NotificationEnabled- [X] T035 [US1] Implement CloseNotification(serviceName) method in Services/NotificationService.cs

- [ ] T032 [US2] Wire MainForm start/stop buttons to ServiceMonitor.StartMonitoringAsync() and StopMonitoringAsync()- [X] T036 [US1] Add NotificationAcknowledged event in Services/NotificationService.cs

- [ ] T033 [US2] Add UI state management: disable start when monitoring active, disable stop when inactive, update status bar text

### UI Layer - Notification Popup (US1)

**Checkpoint**: At this point, User Stories 1 AND 2 should both work independently - can select services from list, add to monitoring, and receive notifications

- [X] T037 [P] [US1] Create NotificationForm class in UI/NotificationForm.cs (Windows Form) - Implemented in NotificationService

---- [X] T038 [US1] Design NotificationForm UI: icon, service name, message, timestamp, OK button - Simplified inline form

- [X] T039 [US1] Implement auto-close timer logic in NotificationForm (default 30 seconds)

## Phase 5: User Story 3 - è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç† (Priority: P3)- [X] T040 [US1] Position NotificationForm at bottom-right of screen with stacking support

- [X] T041 [US1] Style NotificationForm with light red background and warning icon - Basic styling applied

**Goal**: ç›£è¦–è¨­å®šï¼ˆç›£è¦–å¯¾è±¡ã‚µãƒ¼ãƒ“ã‚¹ãƒªã‚¹ãƒˆã€é€šçŸ¥è¨­å®šã€ç›£è¦–é–“éš”ãªã©ï¼‰ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã§ç®¡ç†ã—ã€ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚„ä»–ã®ã‚·ã‚¹ãƒ†ãƒ ã¸ã®å±•é–‹ã‚’å®¹æ˜“ã«ã™ã‚‹

### UI Layer - Main Window (US1 - Minimal)

**Independent Test**: è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ‰‹å‹•ã§ç·¨é›†ã—ã¦ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å†èµ·å‹•ã—ã€ç·¨é›†å†…å®¹ãŒåæ˜ ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã¾ã™ (spec.md US3å—ã‘å…¥ã‚Œã‚·ãƒŠãƒªã‚ª1-4ã‚’å‚ç…§)

- [X] T042 [P] [US1] Create MainForm class in UI/MainForm.cs (main application window)

### Implementation for User Story 3- [X] T043 [US1] Design MainForm UI: status label, start/stop monitoring buttons, service list placeholder

- [X] T044 [US1] Implement Program.cs entry point with DI setup (logger, services)

- [ ] T034 [P] [US3] Implement ConfigurationManager class in ServiceWatcher/Services/ConfigurationManager.cs with LoadAsync(), SaveAsync(), Validate(), CreateDefaultAsync() methods- [X] T045 [US1] Wire ServiceMonitor.ServiceStatusChanged event to NotificationService.ShowNotification

- [ ] T035 [P] [US3] Create SettingsForm in ServiceWatcher/UI/SettingsForm.cs with MonitoringIntervalSeconds NumericUpDown, NotificationDisplayTimeSeconds NumericUpDown, Save/Cancel buttons- [X] T046 [US1] Implement Start Monitoring button click handler in MainForm.cs

- [ ] T036 [US3] Implement ConfigurationManager.GetConfigurationFilePath() to return %LOCALAPPDATA%\ServiceWatcher\config.json- [X] T047 [US1] Implement Stop Monitoring button click handler in MainForm.cs

- [ ] T037 [US3] Implement ConfigurationManager.LoadAsync() with JSON deserialization using System.Text.Json (FR-006)- [X] T048 [US1] Add status label updates on monitoring state changes in MainForm.cs

- [ ] T038 [US3] Implement ConfigurationManager.CreateDefaultAsync() to generate default config.json with 1 default service (wuauserv) on first run (FR-009)

- [ ] T039 [US3] Implement ConfigurationManager.SaveAsync() with backup creation (config.backup.json), validation, and atomic file write (FR-010: å†èµ·å‹•ä¸è¦)### Unit Tests (US1)

- [ ] T040 [US3] Implement ConfigurationManager.Validate() using ConfigurationValidator for range checks: MonitoringIntervalSeconds 1-3600, NotificationDisplayTimeSeconds 0-300, max 50 services

- [ ] T041 [US3] Add error handling in ConfigurationManager.LoadAsync() for file not found, invalid JSON, validation errors (FR-009: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã§èµ·å‹•)- [X] T049 [P] [US1] Create ServiceMonitorTests.cs in tests/Unit/ with basic test structure

- [ ] T042 [US3] Wire SettingsForm to ConfigurationManager: load config on form open, save config on Save button click, apply changes without restart- [X] T050 [P] [US1] Test ServiceMonitor.StartMonitoringAsync starts timer correctly

- [ ] T043 [US3] Implement Program.cs Main() to call ConfigurationManager.LoadAsync() on startup, create default if not found- [X] T051 [P] [US1] Test ServiceMonitor.StopMonitoringAsync cancels timer correctly

- [ ] T044 [US3] Wire ConfigurationManager.ConfigurationChanged event to ServiceMonitor.RefreshMonitoredServicesAsync() for dynamic config reload- [X] T052 [P] [US1] Test service status change detection (Running â†EStopped) raises event

- [X] T053 [P] [US1] Test NotificationService.ShowNotification creates form correctly

**Checkpoint**: All user stories 1, 2, 3 should now be independently functional - configuration file management, service selection, and monitoring with notifications all work- [X] T054 [P] [US1] Test NotificationService.CloseAllNotifications closes all forms



---### Integration Tests (US1)



## Phase 6: User Story 4 - è¨€èªåˆ‡ã‚Šæ›¿ãˆ (Priority: P3)- [X] T055 [US1] Create WindowsServiceTests.cs in tests/Integration/

- [X] T056 [US1] Test real ServiceController interaction (read-only, safe services only)

**Goal**: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è¡¨ç¤ºè¨€èªã‚’æ—¥æœ¬èªã¨è‹±èªã®é–“ã§åˆ‡ã‚Šæ›¿ãˆã‚‰ã‚Œã‚‹ã‚ˆã†ã«ã—ã€å¤šè¨€èªç’°å¢ƒã§ã®åˆ©ç”¨ã‚’å¯èƒ½ã«ã™ã‚‹- [X] T057 [US1] Test monitoring loop with mock service state transitions

- [X] T058 [US1] Test error handling when service doesn't exist (InvalidOperationException)

**Independent Test**: è¨­å®šç”»é¢ã§è¨€èªã‚’åˆ‡ã‚Šæ›¿ãˆã€ã™ã¹ã¦ã®UIè¦ç´ ãŒå³åº§ã«é¸æŠã—ãŸè¨€èªã§è¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã§ãã¾ã™ (spec.md US4å—ã‘å…¥ã‚Œã‚·ãƒŠãƒªã‚ª1-5ã‚’å‚ç…§ã€quickstart.md Scenario 11)

---

### Implementation for User Story 4

## Phase 4: User Story 2 - Service List Display and Selection (P2)

- [ ] T045 [P] [US4] Create Strings.resx in ServiceWatcher/Resources/ with default (fallback) English strings for all UI elements (FR-017)

- [ ] T046 [P] [US4] Create Strings.ja.resx in ServiceWatcher/Resources/ with Japanese translations for all UI elements (FR-013)**Goal**: Display all Windows services and allow user to select/register for monitoring  

- [ ] T047 [P] [US4] Create Strings.en.resx in ServiceWatcher/Resources/ with explicit English strings (same as default)**Independent Test**: Open service list â†Esee all services â†Eregister one â†Esaved to config  

- [ ] T048 [US4] Implement LocalizationService class in ServiceWatcher/Services/LocalizationService.cs with DetectDefaultLanguage(), SetLanguage(), ApplyResourcesTo(), GetString(), GetFormattedString() methods per contracts/ILocalizationService.md**Success Criteria**: SC-001 (register within 30 seconds), SC-005 (search within 3 seconds)

- [ ] T049 [US4] Implement LocalizationService.DetectDefaultLanguage() using CultureInfo.CurrentUICulture.TwoLetterISOLanguageName (FR-014: OSè¨€èªæ¤œå‡ºã€æ—¥æœ¬èªâ†’"ja"ã€ãã®ä»–â†’"en")

- [ ] T050 [US4] Implement LocalizationService.SetLanguage() to update Thread.CurrentThread.CurrentUICulture and CultureInfo.DefaultThreadCurrentUICulture (FR-016: å³æ™‚åæ˜ )### Data Models (US2)

- [ ] T051 [US4] Implement LocalizationService.ApplyResourcesTo() using ComponentResourceManager to recursively update form and all child controls (SC-008: <1ç§’)

- [ ] T052 [US4] Add Language ComboBox to SettingsForm with items "æ—¥æœ¬èª" (ja) and "English" (en) (FR-015)- [x] T059 [P] [US2] Create ApplicationConfiguration class in Models/ApplicationConfiguration.cs

- [ ] T053 [US4] Implement SettingsForm.LanguageComboBox_SelectedIndexChanged() to call LocalizationService.SetLanguage(), iterate Application.OpenForms, call ApplyResourcesTo() on each, save to config (FR-016, FR-018)- [x] T060 [P] [US2] Add MonitoredServices list property to ApplicationConfiguration

- [ ] T054 [US4] Update ApplicationConfiguration.UiLanguage property initialization in Program.cs Main() to call LocalizationService.DetectDefaultLanguage() on first run

- [ ] T055 [US4] Set Form.Localizable=true for MainForm, ServiceListForm, SettingsForm, NotificationForm in designer properties### Service Layer - Configuration (US2)

- [ ] T056 [US4] Add resource keys to Strings.resx/ja.resx/en.resx for all forms: MainForm_Title, ServiceListForm_Title, SettingsForm_Title, NotificationForm_Title, buttons, labels, menus, error messages, notification text (FR-017)

- [ ] T057 [US4] Wire Program.cs Main() to load config.UiLanguage and call LocalizationService.SetLanguage() before showing any forms (FR-018: æ¬¡å›èµ·å‹•æ™‚ã«èª­ã¿è¾¼ã¿)- [x] T061 [P] [US2] Create IConfigurationManager interface in Services/IConfigurationManager.cs

- [x] T062 [US2] Implement ConfigurationManager class constructor in Services/ConfigurationManager.cs

**Checkpoint**: All user stories should now be independently functional - language switching works instantly across all UI elements without restart- [x] T063 [US2] Implement LoadAsync method with JSON deserialization in Services/ConfigurationManager.cs

- [x] T064 [US2] Implement SaveAsync method with backup creation in Services/ConfigurationManager.cs

---- [x] T065 [US2] Implement CreateDefaultAsync method for first-run config in Services/ConfigurationManager.cs

- [x] T066 [US2] Implement Validate method with ConfigurationValidator in Services/ConfigurationManager.cs

## Phase 7: Polish & Cross-Cutting Concerns- [x] T067 [US2] Create ConfigurationValidator class with all validation rules in Services/ConfigurationValidator.cs

- [x] T068 [US2] Implement TryLoadBackupAsync helper for corrupted config recovery

**Purpose**: Improvements that affect multiple user stories- [x] T069 [US2] Add ConfigurationChanged event in Services/ConfigurationManager.cs



- [ ] T058 [P] Add XML documentation comments to all public interfaces and classes per Microsoft conventions### Service Layer - Monitoring Extensions (US2)

- [ ] T059 [P] Add logging statements to all catch blocks and key decision points (service start/stop, config load/save, notification display, language switch)

- [ ] T060 [P] Implement IDisposable pattern for ServiceMonitor to properly dispose ServiceController instances and Timer- [x] T070 [US2] Implement AddServiceAsync method in Services/ServiceMonitor.cs

- [ ] T061 [P] Add icon file ServiceWatcher.ico and set as application icon in project properties- [x] T071 [US2] Implement RemoveServiceAsync method in Services/ServiceMonitor.cs

- [ ] T062 Add NotifyIcon to MainForm for system tray integration with context menu (Start Monitoring, Stop Monitoring, Settings, Exit)- [x] T072 [US2] Implement RefreshMonitoredServicesAsync method in Services/ServiceMonitor.cs

- [ ] T063 Implement MainForm minimize to tray behavior when ApplicationConfiguration.StartMinimized = true- [x] T073 [US2] Implement GetServiceStatusesAsync method in Services/ServiceMonitor.cs

- [ ] T064 Add error message localization for all exception messages using LocalizationService.GetString()

- [ ] T065 Add performance counters: track average status check time, notification display time, language switch time to verify SC-002 (<1s), SC-008 (<1s)### UI Layer - Service List Form (US2)

- [ ] T066 Run all quickstart.md test scenarios manually (Scenarios 1-11) and document results

- [ ] T067 Review code for constitution compliance: <50MB memory, <1% CPU with 20 services, 24-hour stability- [x] T074 [P] [US2] Create ServiceListForm class in UI/ServiceListForm.cs

- [ ] T068 Create default config.json template with sample services (wuauserv, Spooler) and comments- [x] T075 [US2] Design ServiceListForm UI: DataGridView for services, search box, add/remove buttons

- [x] T076 [US2] Implement LoadAllServices method using ServiceController.GetServices()

**Checkpoint**: All features polished and ready for deployment- [x] T077 [US2] Implement search/filter functionality by service name

- [x] T078 [US2] Implement Add Service button handler with ConfigurationManager.SaveAsync

---- [x] T079 [US2] Implement Remove Service button handler with ConfigurationManager.SaveAsync

- [x] T080 [US2] Add monitored services list display (separate grid or highlight)

## Dependencies & Execution Order

### UI Layer - Main Window Integration (US2)

### Phase Dependencies

- [x] T081 [US2] Add "Add Service" button to MainForm.cs

- **Setup (Phase 1)**: No dependencies - can start immediately- [x] T082 [US2] Implement Add Service button click handler to open ServiceListForm

- **Foundational (Phase 2)**: Depends on Setup completion - BLOCKS all user stories- [x] T083 [US2] Add monitored services DataGridView to MainForm.cs

- **User Story 1 (Phase 3)**: Depends on Foundational (Phase 2) - MVP core functionality- [x] T084 [US2] Implement RefreshServiceList method to update monitored services display

- **User Story 2 (Phase 4)**: Depends on Foundational (Phase 2) AND User Story 1 (needs monitoring engine) - UI for service selection- [x] T085 [US2] Wire ConfigurationManager.ConfigurationChanged event to RefreshServiceList

- **User Story 3 (Phase 5)**: Depends on Foundational (Phase 2) - Configuration management (can be done in parallel with US1/US2 if resourced)

- **User Story 4 (Phase 6)**: Depends on Foundational (Phase 2) AND User Story 2 (needs UI forms created) - Localization layer### Unit Tests (US2)

- **Polish (Phase 7)**: Depends on all user stories being complete

- [x] T086 [P] [US2] Create ConfigurationManagerTests.cs in tests/Unit/

### User Story Dependencies- [x] T087 [P] [US2] Test LoadAsync with valid JSON file

- [x] T088 [P] [US2] Test LoadAsync with invalid JSON (should load backup)

- **User Story 1 (P1)**: Can start after Foundational (Phase 2) - No dependencies on other stories - **THIS IS MVP**- [x] T089 [P] [US2] Test SaveAsync creates backup before saving

- **User Story 2 (P2)**: Needs User Story 1 complete (requires ServiceMonitor to be operational) - Adds service selection UI- [x] T090 [P] [US2] Test Validate with valid configuration (all checks pass)

- **User Story 3 (P3)**: Can start after Foundational (Phase 2) - Technically independent but integrates with all stories- [x] T091 [P] [US2] Test Validate with invalid configuration (interval out of range, duplicate services, etc.)

- **User Story 4 (P3)**: Needs User Story 2 complete (requires UI forms to exist for localization) - Adds i18n layer- [x] T092 [P] [US2] Test CreateDefaultAsync generates valid default config



### Within Each User Story### Integration Tests (US2)



- **US1**: ServiceMonitor & NotificationService implementation â†’ NotificationForm UI â†’ Event wiring â†’ Error handling â†’ Logging- [x] T093 [US2] Test full add service flow: UI â†EConfigurationManager.SaveAsync â†Efile written

- **US2**: MainForm & ServiceListForm UI â†’ Service enumeration â†’ Add/remove functionality â†’ Grid binding â†’ State management- [x] T094 [US2] Test configuration reload without restart (FR-010)

- **US3**: ConfigurationManager implementation â†’ File I/O â†’ Validation â†’ SettingsForm UI â†’ Program.cs integration â†’ Dynamic reload- [x] T095 [US2] Test search performance with 100+ services (should complete in <3 seconds)

- **US4**: Resource files (.resx) â†’ LocalizationService implementation â†’ Language detection â†’ SettingsForm language dropdown â†’ Form localization â†’ Program.cs integration

---

### Parallel Opportunities

## Phase 5: User Story 3 - Configuration File Management (P3)

- **Phase 1 (Setup)**: All tasks T001-T005 can run in parallel

- **Phase 2 (Foundational)**: Tasks T006-T010 (models) can run in parallel, T011-T016 (infrastructure) can run in parallel after models**Goal**: Persist settings to JSON file with backup/restore capability  

- **Phase 3 (US1)**: T017-T018 can run in parallel, then T019 (form), then sequential wiring/integration**Independent Test**: Edit config.json â†Erestart app â†Esettings loaded correctly  

- **Phase 4 (US2)**: T025-T026 (forms) can run in parallel, then sequential feature implementation**Success Criteria**: SC-004 (configuration portability 100%)

- **Phase 5 (US3)**: T034-T035 can run in parallel, then sequential integration

- **Phase 6 (US4)**: T045-T047 (resource files) can run in parallel, then T048 (service), then sequential UI integration### Configuration File Handling (US3)

- **Phase 7 (Polish)**: T058-T061 can run in parallel

- [x] T096 [P] [US3] Implement ReloadAsync method in Services/ConfigurationManager.cs

---- [x] T097 [P] [US3] Implement RestoreFromBackupAsync method in Services/ConfigurationManager.cs

- [x] T098 [US3] Add file path resolution logic (%LOCALAPPDATA%\ServiceWatcher\config.json)

## Parallel Example: User Story 1- [x] T099 [US3] Implement ConfigurationExists check method in Services/ConfigurationManager.cs



```bash### Configuration Validation (US3)

# Launch models in parallel (after Foundational):

Task: "Implement ServiceMonitor class in ServiceWatcher/Services/ServiceMonitor.cs"- [x] T100 [P] [US3] Add validation for MonitoringIntervalSeconds (1-3600 range)

Task: "Implement NotificationService class in ServiceWatcher/Services/NotificationService.cs"- [x] T101 [P] [US3] Add validation for NotificationDisplayTimeSeconds (0-300 range)

- [x] T102 [P] [US3] Add validation for max services count (50 max per constitution)

# Then create form:- [x] T103 [P] [US3] Add validation for duplicate service names detection

Task: "Create NotificationForm in ServiceWatcher/UI/NotificationForm.cs"- [x] T104 [P] [US3] Add validation for service name max length (256 chars)



# Then wire together sequentially:### UI Layer - Settings (US3)

Task: "Implement ServiceMonitor.StartMonitoringAsync() with Timer-based polling loop"

Task: "Implement ServiceMonitor.CheckAllServicesAsync() with status checks"- [x] T105 [P] [US3] Add Settings menu item to MainForm.cs

Task: "Wire ServiceMonitor.ServiceStatusChanged event to NotificationService"- [x] T106 [US3] Create SettingsForm class in UI/SettingsForm.cs (optional - can edit config directly)

```- [x] T107 [US3] Add monitoring interval NumericUpDown control to SettingsForm

- [x] T108 [US3] Add notification display time NumericUpDown control to SettingsForm

---- [x] T109 [US3] Implement Save Settings button handler with validation

- [x] T110 [US3] Add StartMinimized checkbox to SettingsForm

## Implementation Strategy- [x] T111 [US3] Add AutoStartMonitoring checkbox to SettingsForm



### MVP First (User Story 1 Only)### Error Handling (US3)



1. Complete Phase 1: Setup (T001-T005)- [x] T112 [US3] Implement error handling for corrupted config.json (load backup or default)

2. Complete Phase 2: Foundational (T006-T016) - **CRITICAL GATE**- [x] T113 [US3] Implement error handling for read-only config file (show error dialog)

3. Complete Phase 3: User Story 1 (T017-T024)- [x] T114 [US3] Implement error handling for missing config directory (create directory)

4. **STOP and VALIDATE**: Run quickstart.md Scenario 3 (Start Monitoring & Detect Service Stop)- [x] T115 [US3] Add user-friendly error messages for all configuration errors

5. Deploy/demo if ready

### Unit Tests (US3)

**Value Delivered**: Core monitoring and notification functionality - immediately useful for single predefined service

- [x] T116 [P] [US3] Test ReloadAsync discards in-memory changes and reloads from file

### Incremental Delivery- [x] T117 [P] [US3] Test RestoreFromBackupAsync successfully restores from backup

- [x] T118 [P] [US3] Test error handling when both config and backup are corrupted (use default)

1. **Foundation Ready**: Complete Setup + Foundational â†’ Can start user stories- [x] T119 [P] [US3] Test validation rules: interval out of range, max services exceeded, etc.

2. **MVP (US1)**: Add User Story 1 â†’ Test independently (Scenario 3) â†’ Deploy/Demo- [x] T120 [P] [US3] Test configuration file location (%LOCALAPPDATA%)

3. **Service Selection (US2)**: Add User Story 2 â†’ Test independently (Scenario 2) â†’ Deploy/Demo

4. **Configuration (US3)**: Add User Story 3 â†’ Test independently (Scenarios 5, 6, 7) â†’ Deploy/Demo### Integration Tests (US3)

5. **Localization (US4)**: Add User Story 4 â†’ Test independently (Scenario 11) â†’ Deploy/Demo

- [x] T121 [US3] Test manual config.json edit â†Eapp restart â†Echanges loaded (FR-010 validation)

Each story adds value without breaking previous stories - can stop at any checkpoint.- [x] T122 [US3] Test config portability: copy config to different machine â†Esame behavior

- [x] T123 [US3] Test first-run scenario: no config exists â†Edefault created automatically (FR-009)

### Parallel Team Strategy

---

With multiple developers (after Foundational phase complete):

## Phase 6: Polish & Cross-Cutting Concerns

- **Developer A**: User Story 1 (T017-T024) - Core monitoring engine

- **Developer B**: User Story 3 (T034-T044) - Configuration management (can work in parallel with A)**Purpose**: Final touches, documentation, and deployment preparation

- **Once US1 + US3 complete**:

  - **Developer A**: User Story 2 (T025-T033) - Service selection UI (depends on US1)### Logging Implementation

  - **Developer B**: User Story 4 (T045-T057) - Localization (can start preparing .resx files early)

- [X] T124 [P] Log all service state changes (Running â†EStopped) with timestamp

Stories complete and integrate independently.- [X] T125 [P] Log configuration load/save operations with success/failure status

- [X] T126 [P] Log monitoring start/stop events with service count

---- [X] T127 [P] Log all errors with full exception details and stack traces

- [X] T128 [P] Implement log file location at %LOCALAPPDATA%\ServiceWatcher\logs\

## Task Summary

### Performance Optimization

| Phase | Task Range | Count | Purpose |

|-------|------------|-------|---------|- [X] T129 [P] Measure memory usage with 50 services (must be <50MB per SC-003)

| Phase 1: Setup | T001-T005 | 5 | Project initialization |- [X] T130 [P] Measure CPU usage with 20 services (must be <1% per SC-003)

| Phase 2: Foundational | T006-T016 | 11 | Core models, interfaces, infrastructure |- [X] T131 [P] Optimize notification display time (must be <1 second per SC-002)

| Phase 3: User Story 1 (P1) | T017-T024 | 8 | Service monitoring & notification (MVP) |- [X] T132 [P] Test 24-hour continuous operation stability (SC-007)

| Phase 4: User Story 2 (P2) | T025-T033 | 9 | Service selection UI |

| Phase 5: User Story 3 (P3) | T034-T044 | 11 | Configuration file management |### UI Polish

| Phase 6: User Story 4 (P3) | T045-T057 | 13 | Internationalization (i18n) |

| Phase 7: Polish | T058-T068 | 11 | Cross-cutting concerns |- [X] T133 [P] Add application icon to MainForm and notification

| **TOTAL** | T001-T068 | **68** | |- [X] T134 [P] Implement proper application exit (stop monitoring, save config)

- [X] T135 [P] Add keyboard shortcuts (F5 for refresh, Ctrl+S for save config)

### Parallel Task Count by Phase- [X] T136 [P] Add status bar with monitoring status and service count

- [X] T137 [P] Implement window state persistence (remember size/position)

- Phase 1: 5 tasks (all can run in parallel)

- Phase 2: 11 tasks (5 models parallel, then 6 interfaces parallel)### Documentation

- Phase 3: 2 initial parallel tasks (ServiceMonitor + NotificationService)

- Phase 4: 2 initial parallel tasks (MainForm + ServiceListForm)- [X] T138 [P] Create README.md with installation instructions

- Phase 5: 2 initial parallel tasks (ConfigurationManager + SettingsForm)- [X] T139 [P] Add inline code comments for complex logic (monitoring loop, error handling)

- Phase 6: 3 initial parallel tasks (3 resource files)- [X] T140 [P] Create CHANGELOG.md documenting v1.0.0 features

- Phase 7: 4 parallel tasks (documentation, logging, IDisposable, icon)- [X] T141 [P] Add XML documentation comments to all public methods



### MVP Scope (Recommended Initial Release)### Deployment



**Minimum Viable Product**: Phases 1-3 only (T001-T024)- [X] T142 Create publish profile for self-contained .NET 8.0 deployment

- **Task Count**: 24 tasks- [X] T143 Test application on Windows 10, Windows 11, Windows Server 2016

- **Delivers**: Service monitoring with notifications for predefined services- [X] T144 Create zip package with executable and default config template

- **User Story**: US1 (P1 priority)- [X] T145 [P] Add version number to application (AssemblyInfo or project properties)

- **Validation**: quickstart.md Scenario 3

- **Constitution Compliance**: All 8 principles satisfied---



---## Task Summary



## Notes**Total Tasks**: 145  

**MVP Tasks (US1 only)**: T001-T058 (58 tasks)  

- [P] tasks = different files, no dependencies within same phase**Full Feature Tasks**: All 145 tasks

- [Story] label maps task to specific user story for traceability

- Each user story should be independently completable and testable### Task Count by Phase

- Commit after each task or logical group

- Stop at any checkpoint to validate story independently- Phase 1 (Setup): 10 tasks

- Tests are EXCLUDED per feature specification (no explicit test request)- Phase 2 (Foundational): 7 tasks

- Run quickstart.md scenarios manually for validation- Phase 3 (US1 - P1): 41 tasks

- Constitution requirements: <50MB memory, <1% CPU, <1s latency, 24-hour stability- Phase 4 (US2 - P2): 37 tasks

- Localization uses .NET standard .resx approach with ComponentResourceManager- Phase 5 (US3 - P3): 28 tasks

- Configuration stored in %LOCALAPPDATA%\ServiceWatcher\config.json- Phase 6 (Polish): 22 tasks


### Task Count by User Story

- **Setup & Foundational**: 17 tasks
- **US1 (P1 - Monitoring & Notification)**: 41 tasks
- **US2 (P2 - Service List & Selection)**: 37 tasks
- **US3 (P3 - Configuration Management)**: 28 tasks
- **Cross-Cutting (Polish)**: 22 tasks

### Parallel Opportunities

Each phase has **[P]** tagged tasks that can be executed concurrently:

- **Phase 1**: T002-T010 (9 parallel tasks) - Project and directory setup
- **Phase 2**: T011-T017 (7 parallel tasks) - Utility classes
- **Phase 3**: T018-T020, T031, T037, T042, T049-T054 (14 parallel tasks) - Models, interfaces, forms
- **Phase 4**: T059-T061, T074, T086-T092 (12 parallel tasks) - Config models and tests
- **Phase 5**: T096-T104, T105, T116-T120 (17 parallel tasks) - Config validation and tests
- **Phase 6**: T124-T145 (22 parallel tasks) - All polish tasks

---

## Dependencies

### Story Completion Order

```
Phase 1 (Setup) â†EPhase 2 (Foundational)
                      â†E              Phase 3 (US1 - P1) â†EMVP Milestone
                      â†E              Phase 4 (US2 - P2)
                      â†E              Phase 5 (US3 - P3)
                      â†E              Phase 6 (Polish)
```

**Independent Stories**: US1, US2, US3 are designed to be independently testable. However, for best user experience, implement in priority order (P1 â†EP2 â†EP3).

### Task Dependencies Within Each Story

**US1 Dependencies**:
- T018-T020 (Models) â†ET021-T030 (ServiceMonitor) â†ET042-T048 (MainForm)
- T031-T036 (INotificationService) â†ET037-T041 (NotificationForm) â†ET045 (Event wiring)

**US2 Dependencies**:
- T059-T060 (Config model) â†ET061-T069 (ConfigurationManager) â†ET074-T080 (ServiceListForm)
- T070-T073 (ServiceMonitor extensions) requires T021-T022 (ServiceMonitor base)

**US3 Dependencies**:
- Requires T061-T069 (ConfigurationManager from US2)
- T096-T099 (Reload/Restore) extends ConfigurationManager
- T100-T104 (Validation) extends ConfigurationValidator from US2

---

## Testing Strategy

### Unit Tests (58 tests planned)

- **ServiceMonitor**: 12 tests (T049-T054 + additional)
- **NotificationService**: 6 tests (T053-T054 + additional)
- **ConfigurationManager**: 14 tests (T086-T092, T116-T120)
- **Validation**: 6 tests (T119)
- **Models**: 10 tests (validation rules)
- **Utils**: 10 tests (Result<T>, Logger, extensions)

### Integration Tests (12 tests planned)

- **US1**: 4 tests (T055-T058)
- **US2**: 3 tests (T093-T095)
- **US3**: 3 tests (T121-T123)
- **Performance**: 2 tests (T129-T130)

### Manual Tests

Use `quickstart.md` for manual testing scenarios:
- 10 detailed test scenarios covering all user stories
- Performance testing with 50 services (SC-003)
- 24-hour stability test (SC-007)

---

## Implementation Notes

### MVP (Minimum Viable Product)

**Scope**: User Story 1 only (Tasks T001-T058)

**What you get**:
- âœEMonitor services and show popup notifications
- âœEStart/Stop monitoring manually
- âœECore error handling (service not found, access denied)
- âœEBasic logging
- âœEUnit and integration tests for monitoring logic

**What's missing** (add with US2/US3):
- âEUI to add/remove services (must edit config.json manually)
- âEService list display and search
- âESettings UI (must edit config.json manually)
- âEConfiguration validation UI

**MVP is production-ready** for users comfortable with manual config editing.

### Incremental Delivery

1. **Iteration 1** (MVP): Tasks T001-T058 â†EDeploy as v0.1.0-alpha
2. **Iteration 2** (US2): Tasks T059-T095 â†EDeploy as v0.2.0-beta
3. **Iteration 3** (US3): Tasks T096-T123 â†EDeploy as v1.0.0-rc1
4. **Iteration 4** (Polish): Tasks T124-T145 â†EDeploy as v1.0.0

### Constitution Compliance

All tasks align with the 7 constitution principles:
- âœE**I. Windows-Native**: Uses ServiceController API
- âœE**II. User Notification First**: US1 core focus
- âœE**III. Minimal Resource**: Performance tasks T129-T132
- âœE**IV. Configuration-Driven**: US3 entire focus
- âœE**V. Testability**: 70 unit/integration tests planned
- âœE**VI. Git Management**: Each task â†Eone commit
- âœE**VII. Feature-Driven Design**: Organized by user story with clear class boundaries

---

## Next Steps

1. **Start with Phase 1** (Setup): Create project structure (T001-T010)
2. **Build Foundation** (Phase 2): Create utility classes (T011-T017)
3. **Implement MVP** (Phase 3): Complete US1 for first testable increment (T018-T058)
4. **Test MVP**: Run manual tests from `quickstart.md` scenarios 1, 3, 7, 8, 9, 10
5. **Commit**: After each task completion per constitution principle VI
6. **Iterate**: Add US2 and US3 incrementally

**Ready to implement**: All tasks have clear file paths and acceptance criteria. Begin with T001! ğŸš€








# 仕様品質チェックリスト: Windowsサービス監視システム

**目的**: 実装フェーズに進む前に仕様の完全性・一貫性・品質を検証する  
**作成日**: 2025-10-30  
**更新日**: 2025-11-05  
**機能**: [spec.md](../spec.md)  
**対象者**: レビュアー（PRレビュー用の標準深度）  
**焦点**: 包括的（すべての領域をカバー）

---

## セクション A: コンテンツ品質

### A1. 技術中立性
- [ ] **CHK-A101**: 仕様本文に実装技術（C#、.NET、Windows Forms等）が記載されていないか？ [Spec §全体]
- [ ] **CHK-A102**: 機能要件（FR-001〜FR-018）がプラットフォーム非依存の言葉で記述されているか？ [Spec §要件]
- [ ] **CHK-A103**: 成功基準（SC-001〜SC-008）が技術スタック無関係の測定可能指標か？ [Spec §成功基準]

### A2. ユーザー中心性
- [ ] **CHK-A201**: すべてのユーザーストーリー（US1〜US4）がシステム管理者の視点から書かれているか？ [Spec §ユーザーシナリオ]
- [ ] **CHK-A202**: 各ユーザーストーリーに「〜として、〜したい」の形式でビジネス価値が明記されているか？ [Spec §US1-4]
- [ ] **CHK-A203**: 受け入れシナリオが「前提・操作・結果」の3要素で明確に定義されているか？ [Spec §受け入れシナリオ]

### A3. 可読性
- [ ] **CHK-A301**: 非技術者（プロダクトマネージャー、ステークホルダー）が理解できる平易な言葉か？ [Spec §全体]
- [ ] **CHK-A302**: 業界用語や専門用語に説明がついているか（例: "ポーリング方式"）？ [Spec §制約事項]
- [ ] **CHK-A303**: すべての必須セクション（ユーザーシナリオ、要件、成功基準、制約事項）が存在するか？ [Spec §構造]

---

## セクション B: 要件の完全性

### B1. 明確化の完了
- [ ] **CHK-B101**: 仕様に [要明確化] マーカーが残っていないか？ [Spec §全体]
- [ ] **CHK-B102**: Clarifications/Session 2025-11-05 で5つの質問すべてに回答があるか？ [Spec §Clarifications]
- [ ] **CHK-B103**: エッジケースの8項目（監視対象不存在、権限不足、設定破損、複数停止、高頻度変化、スリープ復帰、OSフォールバック、言語切替中通知）すべてに対処方針があるか？ [Spec §エッジケース]

### B2. テスト可能性
- [ ] **CHK-B201**: FR-001〜FR-018 の各要件に、客観的に検証可能な基準があるか？ [Spec §機能要件]
- [ ] **CHK-B202**: FR-004（1秒以内通知）、FR-016（即時反映）のような時間制約が定量化されているか？ [Spec §FR-004, FR-016]
- [ ] **CHK-B203**: FR-013〜FR-018（i18n要件）に対応する独立テスト手順が quickstart.md Scenario 11 にあるか？ [Quickstart §Scenario 11]

### B3. 測定可能性
- [ ] **CHK-B301**: SC-001〜SC-008 の成功基準すべてに数値目標（秒数、%、MB等）があるか？ [Spec §成功基準]
- [ ] **CHK-B302**: SC-003（20サービス、CPU<1%、メモリ<50MB）のベンチマーク手順が定義されているか？ [Gap]
- [ ] **CHK-B303**: SC-008（言語切替<1秒）の測定方法が明確か（タイマー計測、体感、自動テスト）？ [Gap]

### B4. スコープ定義
- [ ] **CHK-B401**: 前提条件（Windows 10+、.NET 6.0+、サービス概念理解）が明示されているか？ [Spec §前提条件]
- [ ] **CHK-B402**: 制約事項（Windows専用、管理者権限、ポーリング方式、JSON平文、ja/enのみ）が明記されているか？ [Spec §制約事項]
- [ ] **CHK-B403**: スコープ外の機能（例: サービス自動再起動、リモート監視）が明示的に除外されているか？ [Gap]

---

## セクション C: 要件の一貫性

### C1. 内部整合性
- [ ] **CHK-C101**: US4（言語切り替え）とFR-013〜FR-018の間に矛盾がないか？ [Spec §US4, §FR-013-018]
- [ ] **CHK-C102**: FR-017（すべてのUI要素翻訳）とUS4受け入れシナリオ3（メニュー、ボタン、ラベル、メッセージ、通知）の範囲が一致しているか？ [Spec §FR-017, §US4-3]
- [ ] **CHK-C103**: SC-008（言語切替<1秒）とFR-016（即時反映）の時間制約が整合しているか？ [Spec §SC-008, §FR-016]

### C2. 設計書との整合性
- [ ] **CHK-C201**: data-model.md の ApplicationConfiguration.UiLanguage（"ja" or "en"）とFR-018（config.json保存）が一致しているか？ [DataModel, Spec §FR-018]
- [ ] **CHK-C202**: contracts/ILocalizationService.md のメソッド群（DetectDefaultLanguage、SetLanguage、ApplyResourcesTo等）がFR-013〜FR-017をカバーしているか？ [Contracts, Spec §FR-013-017]
- [ ] **CHK-C203**: quickstart.md Scenario 11 のテスト手順が、US4の5つの受け入れシナリオすべてを検証できるか？ [Quickstart §11, Spec §US4]

### C3. タスクとの整合性
- [ ] **CHK-C301**: tasks.md が破損しておらず、すべての要件（FR-001〜FR-018）に対応するタスクがあるか？ [Tasks, Spec §要件] ⚠️ CRITICAL
- [ ] **CHK-C302**: FR-012（非管理者権限）に対する専用テストタスクがあるか？ [Gap, Spec §FR-012]
- [ ] **CHK-C303**: SC-003（20サービスベンチマーク）に対する測定タスクがあるか？ [Gap, Spec §SC-003]
- [ ] **CHK-C304**: SC-004（設定移植性100%）に対する検証タスクがあるか？ [Gap, Spec §SC-004]

---

## セクション D: 要件の明瞭性

### D1. 曖昧性の排除
- [ ] **CHK-D101**: FR-017「すべてのUI要素」にログメッセージが含まれるか明確か？ [Ambiguity, Spec §FR-017]
- [ ] **CHK-D102**: FR-014「OSの言語設定を検出」で、日本語以外の言語が英語にフォールバックする仕様が明記されているか？ [Spec §制約事項]
- [ ] **CHK-D103**: FR-010「再起動なしに反映」がすべての設定変更（サービス追加/削除、監視間隔変更、言語変更）に適用されるか明確か？ [Spec §FR-010, FR-016]

### D2. 定義の明確化
- [ ] **CHK-D201**: エンティティ「設定情報」のすべての属性（監視間隔、通知表示時間、設定パス、サービスリスト、言語）が仕様に定義されているか？ [Spec §主要エンティティ]
- [ ] **CHK-D202**: FR-005「停止理由（取得可能な場合）」で、取得不可時の代替表示が明確か？ [Spec §FR-005]
- [ ] **CHK-D203**: FR-011「デフォルト30秒」で、この値がユーザー設定可能か明記されているか？ [Gap, Spec §FR-011]

### D3. 例外処理の明確化
- [ ] **CHK-D301**: エッジケース「設定ファイル破損」の処理方法（エラー表示→デフォルト設定起動）が明確か？ [Spec §エッジケース, §US3-4]
- [ ] **CHK-D302**: エッジケース「複数サービス同時停止」の通知方法（個別通知 or 統合通知）が明確か？ [Gap, Spec §エッジケース]
- [ ] **CHK-D303**: エッジケース「言語切替中の通知」でどちらの言語を使用するか明確か？ [Gap, Spec §エッジケース]

---

## セクション E: カバレッジ

### E1. 機能カバレッジ
- [ ] **CHK-E101**: 4つのユーザーストーリー（US1-4）が、想定される利用シーン（開発環境、本番環境、複数サーバー管理、テスト環境）をカバーしているか？ [Spec §ユーザーシナリオ, §利用シーン]
- [ ] **CHK-E102**: 18の機能要件（FR-001〜FR-018）が、すべてのユーザーストーリーの受け入れシナリオ（19シナリオ）を実現できるか？ [Spec §要件, §受け入れシナリオ]
- [ ] **CHK-E103**: i18n要件（FR-013〜FR-018）が、US4の5つの受け入れシナリオすべてに対応しているか？ [Spec §FR-013-018, §US4]

### E2. エッジケースカバレッジ
- [ ] **CHK-E201**: 8つのエッジケースすべてに、対処方針または優先順位が割り当てられているか？ [Spec §エッジケース]
- [ ] **CHK-E202**: エッジケース「高頻度停止起動」に対するフラッディング対策（通知頻度制御）が要件化されているか？ [Gap, Spec §エッジケース]
- [ ] **CHK-E203**: エッジケース「スリープ復帰」に対する監視再開ロジックが要件化されているか？ [Gap, Spec §エッジケース]

### E3. 非機能カバレッジ
- [ ] **CHK-E301**: パフォーマンス（SC-002: 1秒、SC-003: CPU<1%/メモリ<50MB、SC-008: 1秒）がすべての重要操作をカバーしているか？ [Spec §成功基準]
- [ ] **CHK-E302**: 信頼性（SC-007: 24時間稼働安定性100%）に対する具体的な検証手順があるか？ [Gap, Spec §SC-007]
- [ ] **CHK-E303**: ユーザビリティ（SC-001: 30秒、SC-005: 3秒、SC-006: 情報完全性100%）が主要タスクをカバーしているか？ [Spec §成功基準]

---

## セクション F: 実装準備状況

### F1. タスク分解の健全性
- [ ] **CHK-F101**: tasks.md の形式が正しく（混在チェックボックスなし）、全68タスクがパース可能か？ [Tasks] ⚠️ CRITICAL
- [ ] **CHK-F102**: タスクID（T001〜T068）に重複や欠番がないか？ [Tasks] ⚠️ CRITICAL
- [ ] **CHK-F103**: 7つのフェーズ（Setup、Foundational、US1-P1、US2-P2、US3-P3、US4-P3、Polish）が論理的な依存順序か？ [Tasks]

### F2. 設計成果物の完全性
- [ ] **CHK-F201**: research.md のSection 7（i18n戦略）が、FR-013〜FR-018の技術決定を正当化しているか？ [Research §7, Spec §FR-013-018]
- [ ] **CHK-F202**: data-model.md の3エンティティ（監視対象サービス、設定情報、通知イベント）が、すべてのFRで使用されるデータをカバーしているか？ [DataModel, Spec §主要エンティティ]
- [ ] **CHK-F203**: contracts/ の4インターフェース（ILocalizationService含む）が、主要なアーキテクチャ境界を定義しているか？ [Contracts, Plan §Project Structure]

### F3. テストシナリオの実行可能性
- [ ] **CHK-F301**: quickstart.md の11シナリオが、実際に手動で実行可能な手順か？ [Quickstart]
- [ ] **CHK-F302**: Scenario 11（Language Switching）の「<1s switch」が、ストップウォッチで測定可能な明確な基準か？ [Quickstart §11, Spec §SC-008]
- [ ] **CHK-F303**: すべてのシナリオに期待結果が明記され、成功/失敗の判定が明確か？ [Quickstart]

---

## 検証結果サマリー

### 重大度別カウント
- **CRITICAL** (実装ブロッカー): 2項目
  - CHK-C301: tasks.md ファイル破損 ⚠️
  - CHK-F101: tasks.md 形式不正 ⚠️
  
- **HIGH** (実装前必須): 8項目
  - CHK-B302, B303: ベンチマーク/測定手順未定義
  - CHK-C302, C303, C304: テストタスク欠落
  - CHK-D101: FR-017 翻訳範囲曖昧
  - CHK-D302, D303: エッジケース処理不明確

- **MEDIUM** (品質向上推奨): 12項目
  - CHK-B403: スコープ外機能未明示
  - CHK-D203, D211: デフォルト値設定可否不明
  - CHK-E202, E203: エッジケース要件化不足
  - CHK-E302: 信頼性検証手順不足
  - その他

- **LOW** (マイナー改善): 残りの項目

### 推奨アクション（優先順位順）

1. **即座に対処 (CRITICAL)**
   - [ ] tasks.md を完全に再生成（ファイルバックアップ→削除→再実行）
   - [ ] タスクID T045〜T057 の重複を解消

2. **実装前に対処 (HIGH)**
   - [ ] FR-012, SC-003, SC-004 に対するテストタスクを tasks.md に追加
   - [ ] FR-017 の翻訳範囲（ログ含むか）を spec.md で明確化
   - [ ] SC-003, SC-008 の測定手順を quickstart.md または tasks.md に追加
   - [ ] エッジケース「複数停止」「言語切替中通知」の処理方針を spec.md に追加

3. **品質向上推奨 (MEDIUM)**
   - [ ] スコープ外機能（サービス再起動、リモート監視等）を spec.md に明記
   - [ ] エッジケース「高頻度変化」「スリープ復帰」を FR/タスクに昇格
   - [ ] SC-007（24時間稼働）の具体的検証手順を定義

4. **次フェーズで対応 (LOW)**
   - その他のマイナー曖昧性解消

---

## 次のステップ

⚠️ **実装開始前に CRITICAL/HIGH 項目の対処が必須です**

### 即座に実行すべきコマンド

```powershell
# 1. 破損した tasks.md のバックアップ
Copy-Item specs/001-service-monitor/tasks.md specs/001-service-monitor/tasks.md.corrupted-2025-11-05 -Force

# 2. 破損ファイルの削除
Remove-Item specs/001-service-monitor/tasks.md

# 3. タスク再生成（/speckit.tasks を再実行）
# AIチャット: "Follow instructions in speckit.tasks.prompt.md"

# 4. タスク追加（/speckit.tasks 完了後）
# AIチャット: "tasks.mdにFR-012, SC-003, SC-004のテストタスクを追加"

# 5. 仕様曖昧性解消
# AIチャット: "spec.mdのFR-017にログメッセージ翻訳有無を明記、エッジケース2項目の処理方針を追加"
```

### 推奨ワークフロー

1. ✅ `/speckit.checklist` 完了（このチェックリスト生成）
2. ⏳ **CRITICAL 修正**: tasks.md 再生成
3. ⏳ **HIGH 修正**: テストタスク追加、仕様曖昧性解消
4. ⏳ **再検証**: このチェックリストを再実行（全項目 ✓ 確認）
5. ✅ `/speckit.implement` へ進む

---

## 注記

- このチェックリストは `/speckit.analyze` の発見事項（9 findings）を統合しています
- 各 CHK-XXXX 項目は、仕様の具体的なセクション/ギャップ/曖昧性にトレース可能です
- `[Spec §X]` = spec.md のセクション参照
- `[Gap]` = 仕様に明記されていない項目
- `[Ambiguity]` = 解釈が複数可能な記述
- チェック完了時は `- [ ]` を `- [x]` に変更してください
